-*- Outline -*-

* Abstract

這一份文件是 jabbot 的 Perl API ，給有意協同開發 jabbot 的善男信女們
隨便看看的。

* Modules

** Jabbot::Lib

這個函式庫裡面有一些方便做文字處理的函式。

** Jabbot::ModLib

這個函式庫主要是簡單處理掉與 core bot 之間的傳訊。每一個 module 的程式
架構都跟 mod/template 這個檔案很像，前面 use Jabbot::ModLib 裡面會把 
core bot 傳來的訊息存成 %MSG 這個全域變數，主要會用到的資訊有：

    $MSG{to}
    $MSG{from}
    $MSG{body}

在概念上與 email 的是一樣的，在處理過之後，要回訊給 core bot 的方法就是
呼叫 reply() 函式：

    reply({
        from     => $BOT_NICK, # $BOT_NICK is my nick on irc.
	to       => $MSG{to},
	body     => $reply,
	priority => $priority
    });

reply() 函式所接受的 hash 格式就是 MSG 的 hash ，但你可以自已加減，不
過core bot 不一定會處理，看不懂的 header 則會 ignore。如果你的 module 
不打算對訊息做出回應（比如說指令格式不符），那就儘早呼叫 exit(0)。

* Examples

請見 mod/template

* 測試

請把 jabbot2/ 這個目錄 copy 到 ~/bot/ 去，再執行

    cd ~/bot/jabbot2/
    perl -I lib bin/jabbot-console.pl

這個 script 會出現一個 prompt ，現在你便可以和 jabbot 一對一談話，測試
剛剛好的 module。所有的 module 都放在 mod/ 子目錄下，要有 .pl 副檔名，
也要 chmod +x 。如果只想單獨測一個 module ，就把其他不要的移開。

~/bot/jabbot2/ 這個目錄是 runtime 的環境，裡面應該要這樣的目錄架構：

    bin/jabbot.pl	  # IRC bot
    bin/jabbot-consol.pl  # Console bot
    db/			  # 各個 module 會存 data 的地方
    mod/		  # 放 module 的地方

如果 mod/blah.pl 沒有 +x 的話，就會造成像這樣的錯誤：

    open2: exec of /home/gugod/bot/jabbot2/mod/blah.pl failed

請注意。


