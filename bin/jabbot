#!/usr/bin/env perl
use common::sense;
use FindBin;
use lib "$FindBin::Bin/../lib";

use UNIVERSAL::require;

my %runnables = (
    irc     => 'Jabbot::Front::IRC',
    console => 'Jabbot::Front::Console',
    xmpp    => 'Jabbot::Front::XMPP',
    github  => 'Jabbot::Back::GitHub',
    memory  => 'Jabbot::Back::Memory',
    cpantw  => 'Jabbot::Back::CPANTaiwan',
    twitter => 'Jabbot::Back::Twitter',
    irccat  => 'Jabbot::Back::Irccat',
    core    => 'Jabbot::Core'
);

use Jabbot;

my $cmd = shift @ARGV;

given($cmd) {
    when('run') {
        my $runnable = shift @ARGV or die "Need a name.";
        my $module = $runnables{$runnable};
        die "Do not know how to run $runnable\n" unless $module;
        $module->require or die "Fail to load $module: $@\n";
        $module->run;
    }
}
