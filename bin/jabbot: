#!/usr/bin/env perl
use common::sense;
use FindBin;
use lib "$FindBin::Bin/../lib";

$ENV{JABBOT_ROOT} = "$FindBin::Bin/..";

use UNIVERSAL::require;

my $class = 'Jabbot::Core';
$class->require;

my $j = $class->new;
my $ans = [];

if (@ARGV > 0) {
    my $q = join(" ", @ARGV);
    $ans = $j->answers(question => $q, channel => ($ENV{CHANNEL} || '/console/jabbot:'));
    say "\nanswers:";
    say "  $_->{plugin}: $_->{content}" for @$ans;
}
else {
    while(<>) {
        chomp;
        my $q = $_;

        $ans = $j->answers(question => $q, channel => ($ENV{CHANNEL} || '/console/jabbot:'));

        say "\nQ: $q";
        say "A: $_->{plugin}: $_->{content}" for @$ans;
    }
}

